---
typora-root-url: assets
---

# 基于TP5和PHPExcel的农业局报表自查系统

## 																								文件结构见tree.txt

```javascript
    昆明农业局报表自查系统是一款受昆明农业局委托开发的作为农业局表格数据检查纠错的表格处理软件,该系统结合实际使用需求,加入了用户登录以及下级用户分配管理,权限管理等基本用户管理功能,其中表格检查系统的主要功能和流程大致为:
	选定要检查的表格类型(应需所求此处有两种类型表格检查)===>点击进行文件导入(选择特定的表格,因为导入数据库时以excel文件字段逐列处理)===>通过简单的点选操作实现原表格导出\带标记的整表导出\只导出有错误的表格项等操作,软件系统的初衷是受农业局所托解决表格数据项字段繁多难以人力应付且工作量巨大,还有存在人为操作的误差可能存在.
        系统对表格的审查大致分为如下几类:
	与实际不相符合的数据字段(如负债表中固定资产清理核实数不能为0),
	或逻辑上明显错误(如清查表中集体土地总面积\农用地面积\林地面积为0)	
	或人为收集的数据明显有误(如某些指标项加和总数值小于单项数值等)
	或存在异或的条件检索项(如同一指标的不同显示的地方数值不同时为0或不同时不为0[逻辑上允许两处都为0或同时不为0且不相等])
        系统功能补充说明:
	由于考虑基层使用者对电脑知识有所欠缺,所以特意在将处理后的表格以不同色块导出的基础上以最后几列不作为判断的字段的连续着色来表示改行数据是否有问题,在导出的表格文件中可以直接先看最后几行作为标识标记的地方是否着色,如果有再细看前面出错的色块对应的字段就可以快速实现查看和定位.
```

![img](/../README.assets/clip_image002.jpg)

登录界面

 

![img](/../README.assets/clip_image003.png)

输入用户名 \ 密码

![img](/../README.assets/clip_image005.jpg)

 

 

 

![img](/../README.assets/clip_image007.jpg)

系统功能布局图

其中:

 

![img](/../README.assets/clip_image008.png)                  ![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image009.png) 

功能分类区                                   展开各功能选择区

 

 

## 负债表操作界面 的  操作指南:

 

 ![img](/../README.assets/clip_image011.jpg)

点击左侧负债表操作,在右边可见该功能块的可选择操作功能函数,有

 

文件导入  顾名思义就是点击该按钮上传要检测的表格文件,支持.xls 以及 .xlsx后缀格式的Excel文件.操作流程如下:

 

![img](/../README.assets/clip_image013.jpg)

点击按钮出现这一界面

![img](/../README.assets/clip_image015.jpg)

点击选择导入的Excel表格在电脑本机上找到要操作的表格文件并单击,然后选择下面的打开按钮

![img](/../README.assets/clip_image017.jpg)

出现这个浮窗提示说明上传成功

 

 

![img](/../README.assets/clip_image019.jpg)

出现这一界面提示说明上传表格有误或上传文件超过限制大小

 

(如何测试是否真的导入文件成功?)

​    点击清空数据表选项,如果提示成功,则当前该表下面应该没有任何数据,

![img](/../README.assets/clip_image020.png)

​    而此时操作选项页面应该是没有数据显示的

![img](/../README.assets/clip_image022.jpg)

 

### 未标记原表导出

​    就是将你刚刚导入的表从数据库读取出来生成表格,是对表格是否导入成功的一个检查方式,也是到出数据库看看里面当前表中有些什么数据的方法.

​    操作方法就是直接点击 未标记原表导出 按钮,浏览器自动下载到本地,然后可以打开查看,有时候打开时会提示格式错误或其他错误,这是Office版本不同而引起的,不会影响打开的效果.

![img](/../README.assets/clip_image024.jpg)

导出下载到本地

![img](/../README.assets/clip_image026.jpg)

全表导出,无任何标记示例图

 

### 带标记全表

​    在导出全表的基础上添加了错误检测的功能,简单来说就是在全表的基础上标记出要检测的列项是否有错,有错则颜色标记,具体标记意义解释如下:

![img](/../README.assets/clip_image028.jpg)

### 带标记全表输出示例图

![img](/../README.assets/clip_image030.jpg)

带标记全表输出表格示例图

![img](/../README.assets/clip_image032.jpg)

不同颜色对不同列数的标记区别明显更显而易见

有以上图可以清晰的看得出哪些列项的哪一行是有错误的(就是有颜色标记的),还有一点很很重要,就是最后几列本来是不用检测的列项,这是我们为了更加人性化而加上的独特一笔,就是在打开标记全表的时候可以直接先看最后几列标记列是否有颜色,如果是有颜色的则代表这一列中存在错误,再往前查看错误所在列,没有颜色则证明该行数据完全正确.

![img](/../README.assets/clip_image033.png)

先看表格的最后几行连续色块是否有颜色,确定是否有错再细看

 

### 被标记子表

​    点击按钮自动生成被标记子表并在浏览器中下载到本地

​    此表的意义在于仅将有错的数据行提取出来,更加方便查看

![img](/../README.assets/clip_image035.jpg)

 

负债表标记子表输出在本地示例图

![img](/../README.assets/clip_image036.png)

负债表标记子表输出表格图,其中最后一行的不同颜色代表出错个数,错误项越多颜色越深,分别从黄\蓝\棕.

![img](/../README.assets/clip_image038.jpg)

后面标记色块颜色越深,该行数据错误项越多

### 清空数据库

![img](/../README.assets/clip_image039.png)

### 清空该表下的数据库存储

 

 

 

清查表操作界面 的  操作指南:

![img](/../README.assets/clip_image041.jpg)

## 清查表操作界面

 

文件导入  和 清空数据库 的操作和负债表的操作和功能是一样的

 

未标记原表导出  \ 带标记全表 \ 带标记子表 的操作和功能都是一样的,

 

**不同之处**在于:

![img](/../README.assets/clip_image043.jpg)

### 清查表全部标记输出

清查表全部标记输出的表格最后几列是标识是否有错以及错误的个数,同理,颜色越深错误越多,分别从蓝 \ 红 \ 棕

 

还有一点很重要,就是 清查表全部标记输出中 AY 到 BB 列原本不是检测项,此处是用于标识两处林地面积是否一个为0一个不为0的错误情况.

![img](/../README.assets/clip_image044.png)

两处林地面积0的错误检测标识行

增加这一行标记以后在输出带标记全表以及带标记子表中查看的时候就直接结合左边标识错误色块以及右边标识色块来看检测结果.

![img](/../README.assets/clip_image046.jpg)

仅有右边色块有颜色

 

![img](/../README.assets/clip_image048.jpg)

两边标识色块都有颜色或穿插有颜色标记

 

![img](/../README.assets/clip_image050.jpg)

两侧都没有色块标记,说明没有错误

# 展示面板说明

 

![img](/../README.assets/clip_image052.jpg)

## 负债表展示界面

此处将要检测的列项罗列并将检测结果展示出来,一目了然

 

 

 

![img](/../README.assets/clip_image054.jpg)

## 清查表展示界面

同理展示待检测项的检测结果,值得注意的是此处两个林地面积标记出的不一定是错项,检测导出的表格里面标记正确显示正常,此处因为是前端框架语法实现有点小问题,

​					切记,此处检测结果参考检测输出的表格!!!

​					切记,此处检测结果参考检测输出的表格!!! 

​					切记,此处检测结果参考检测输出的表格!!!

 

 

用户中心 

​    ![img](/../README.assets/clip_image056.jpg)

用户中心功能之密码修改

 

![img](/../README.assets/clip_image058.jpg)

用户中心之用户添加

 

说明:

​    该系统当前为测试服务器,文件上传大小有限制,测试上传导入文件推荐2200行左右;

​    每个登录用户操作的都是自己用户空间下的数据,不用担心数据泄露或数据混乱;

​    建议每次检测完并下载生成表格以后随手清空数据库,每次单文件操作(即上传一个表格文件,操作完之后清空数据表再重复执行).

